<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Categories | BudgetWise</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="/categories.js" defer></script>
  </head>
  <body class="bg-slate-50 text-slate-900">
    <div class="mx-auto flex min-h-screen max-w-4xl flex-col gap-8 px-4 py-10">
      <nav class="flex items-center justify-between text-sm font-medium">
        <a class="text-blue-600 hover:underline" href="/index.html">Back to Dashboard</a>
        <button
          id="logout-button"
          class="rounded border border-slate-300 px-3 py-1 text-slate-700 hover:bg-slate-100"
          type="button"
        >
          Logout
        </button>
      </nav>

      <header>
        <h1 class="text-3xl font-semibold">Manage Categories</h1>
        <p class="mt-2 text-sm text-slate-600">
          Create personalized spending categories and map them to the 50/30/20 budget buckets.
        </p>
      </header>

      <section class="flex flex-wrap items-center gap-3">
        <button
          id="export-template-button"
          type="button"
          class="rounded bg-blue-600 px-4 py-2 text-sm font-semibold text-white hover:bg-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:ring-offset-2"
        >
          Export Template
        </button>
        <label
          for="import-template-input"
          class="cursor-pointer rounded border border-slate-300 px-4 py-2 text-sm font-semibold text-slate-700 hover:bg-slate-100 focus-within:outline-none focus-within:ring-2 focus-within:ring-slate-400 focus-within:ring-offset-2"
        >
          Import Template
        </label>
        <input id="import-template-input" type="file" accept="application/json" class="hidden" />
      </section>

      <section class="grid gap-6 md:grid-cols-2">
        <form id="category-form" class="space-y-4 rounded-lg bg-white p-6 shadow">
          <h2 class="text-xl font-semibold">Add Category</h2>

          <div>
            <label class="block text-sm font-medium text-slate-700" for="category-name">Name</label>
            <input
              id="category-name"
              name="name"
              type="text"
              required
              maxlength="40"
              class="mt-1 w-full rounded border border-slate-300 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500"
            />
          </div>

          <div>
            <label class="block text-sm font-medium text-slate-700" for="category-type">Budget Bucket</label>
            <select
              id="category-type"
              name="budget_type"
              required
              class="mt-1 w-full rounded border border-slate-300 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500"
            >
              <option value="Necessities">Necessities (50%)</option>
              <option value="Leisure">Leisure (30%)</option>
              <option value="Savings">Savings (20%)</option>
            </select>
          </div>

          <button
            type="submit"
            class="w-full rounded bg-blue-600 px-4 py-2 font-semibold text-white hover:bg-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:ring-offset-2"
          >
            Create Category
          </button>
        </form>

        <div class="rounded-lg bg-white p-6 shadow">
          <h2 class="text-xl font-semibold">Your Categories</h2>
          <p class="mt-2 text-sm text-slate-500">
            Categories cannot be deleted while they have expenses associated with them.
          </p>

          <ul id="category-list" class="mt-4 divide-y divide-slate-200"></ul>
          <p id="category-empty-state" class="mt-4 text-sm text-slate-500">
            No categories yet. Add your first one using the form.
          </p>
        </div>
      </section>

      <p id="status-message" class="hidden rounded p-3 text-sm"></p>

      <section class="grid gap-6 md:grid-cols-2">
        <form id="recurring-form" class="space-y-4 rounded-lg bg-white p-6 shadow">
          <h2 class="text-xl font-semibold">Add Recurring Payment</h2>

          <div>
            <label class="block text-sm font-medium text-slate-700" for="recurring-description">Description</label>
            <input
              id="recurring-description"
              name="description"
              type="text"
              required
              maxlength="255"
              class="mt-1 w-full rounded border border-slate-300 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500"
            />
          </div>

          <div>
            <label class="block text-sm font-medium text-slate-700" for="recurring-amount">Default Amount</label>
            <input
              id="recurring-amount"
              name="default_amount"
              type="number"
              step="0.01"
              min="0"
              required
              class="mt-1 w-full rounded border border-slate-300 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500"
            />
          </div>

          <div>
            <label class="block text-sm font-medium text-slate-700" for="recurring-category">Category</label>
            <select
              id="recurring-category"
              name="user_category_id"
              required
              class="mt-1 w-full rounded border border-slate-300 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500"
            ></select>
            <p id="recurring-category-empty" class="hidden text-xs text-slate-500">
              Add a category first to create recurring payments.
            </p>
          </div>

          <button
            type="submit"
            class="w-full rounded bg-emerald-600 px-4 py-2 font-semibold text-white hover:bg-emerald-500 focus:outline-none focus:ring-2 focus:ring-emerald-400 focus:ring-offset-2"
          >
            Create Template
          </button>
        </form>

        <div class="rounded-lg bg-white p-6 shadow">
          <h2 class="text-xl font-semibold">Recurring Payments</h2>
          <p class="mt-2 text-sm text-slate-500">
            Use these templates for quick logging from the dashboard.
          </p>

          <ul id="recurring-list" class="mt-4 divide-y divide-slate-200"></ul>
          <p id="recurring-empty-state" class="mt-4 text-sm text-slate-500">
            No recurring payments yet. Create your first template.
          </p>
        </div>
      </section>
    </div>
  </body>
</html>
